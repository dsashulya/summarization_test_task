# Суммаризация диалогов

### 0. requirements.txt
Все необходимые библиотеки и их версии лежат в [requirements.txt]():

```
pip install -r requirements.txt
```

### 1. Данные
Использовались данные Reddit из датасета [ConvoSumm](https://github.com/Yale-LILY/ConvoSumm).

Для возможности сравнения последующего дообучения с результатами авторов использовалось то же разделение ```train/val/test```, что и в [публикации](https://arxiv.org/pdf/2106.00829.pdf). Однако в полном датасете (```reddit.all.newsumms.*```) встречались лишние newline символы, из-за которых в оригинальном разделении были примеры, состоящие из одного сообщения, оторванного от оригинального треда. В самих суммаризациях (файлы ```*.target```) такой проблемы не было обнаружено, поэтому я сделала свое разделение на выборки, опираясь на индексы примеров в ```train.target``` и ```val.target```. Код находится в [preprocess.py](), скрипт для запуска:

```
cd data
python preprocess.py ARGS???
```

### 2. Модель_и
В качестве первой модели для валидации был взят [LongT5](https://arxiv.org/pdf/2112.07916.pdf) с 3В параметров ([long-t5-tglobal-xl](https://huggingface.co/google/long-t5-tglobal-xl)). Брать модель большего размера было невозможно из-за ограничений по памяти. 

Я выбрала первой моделью T5, так как ... . LongT5 был выбран в силу наличия последовательностей, превосходящих 1024 токена уже в zero shot условиях, что делало обычный T5 неэффективным для такой задачи при имеющихся ресурсах.

### 3. Гипотезы
#### Внутри модели:
1. 
    a. Few shot подход даст результаты лучше, чем zero shot.

    b. Few shot будет показывать результаты лучше с увеличением количества примеров.


2. Наличие заголовков во входных данных улучшит результат.


3. 
    a. Предобработанные данные (arg-filtered и arg-graph) дадут результат лучше vanilla.

    b. arg-filtered дадут результат лучше arg-graph ???


4. Более детальный prompt с инструкциями даст результат лучше короткого. 

#### Между моделями:


### 4. Метрики
Rouge

Perplexity

### 5. Эксперименты
Гиперпараметры
```
script
```

### 6. Результаты

* Метрики

* Примеры суммаризаций
